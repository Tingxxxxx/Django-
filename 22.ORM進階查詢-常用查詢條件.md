# ORMæ¡†æ¶è³‡æ–™é€²éšæŸ¥è©¢ç­†è¨˜

## 1. filter() èˆ‡ exclude() åŸºæœ¬æ¢ä»¶æŸ¥è©¢
- åœ¨ Django ä¸­ï¼Œé€²éšæŸ¥è©¢æ¢ä»¶ä¸»è¦é€é ORMï¼ˆObject-Relational Mappingï¼‰ä¾†å¯¦ç¾ï¼Œå¯ä»¥ä½¿ç”¨ Python ä»£ç¢¼é€²è¡Œè¤‡é›œçš„è³‡æ–™æŸ¥è©¢ã€‚
- filter() èˆ‡ exclude() æŸ¥è©¢å¾Œæœƒè¿”å›ä¸€å€‹ Query_set å°è±¡(å¯ç†è§£æˆä¸€å€‹åˆ—è¡¨ï¼Œä¸”å…§å«å…ƒç´ éƒ½æ˜¯å°è±¡)

âœ… **è£œå……çŸ¥è­˜: æŸ¥è©¢çµæœ.query å¯ä»¥æŸ¥çœ‹åº•å±¤åŸ·è¡Œçš„sqlèªå¥**


### ç¯„ä¾‹:
```python
from myapp.models import Product

# æŸ¥è©¢åƒ¹æ ¼å¤§æ–¼ 100 çš„å•†å“
products = Product.objects.filter(price__gt=100)

# æŸ¥è©¢åç¨±ä¸æ˜¯ "iPhone" çš„å•†å“
products = Product.objects.exclude(name='iPhone')
```

## 2. å¾ Query_set å°è±¡ä¸­è¿”å›å…·é«”å€¼

**âœ… éæ­· query_set:**
```python
query_set = Model.objects.filter(...)

for obj in query_set:
    print(obj.field_name)  # å­˜å–ç‰©ä»¶çš„æ¬„ä½
```


**âœ… ä½¿ç”¨ values() èˆ‡ values_list è¿”å›æŒ‡å®šæ¬„ä½çš„å€¼:**

```python
# .values() è¿”å›ä¸€å€‹ QuerySetï¼Œå…¶ä¸­æ¯å€‹å…ƒç´ æ˜¯ dict
products = Product.objects.filter(price__gt=100).values('name') # çµæœ:[{'name: 'xxx'},{},{}...]

# é€éå­—å…¸æ“ä½œå–å‡ºå…·é«”å€¼
for product in product_names:
    print(product['name'])  # é€™æ¨£å¯ä»¥ç›´æ¥å–å‡ºæ¯å€‹å•†å“çš„åç¨±

# .values_list() è¿”å›ä¸€å€‹ QuerySetï¼Œå…¶ä¸­æ¯å€‹å…ƒç´ æ˜¯ tuple
product_data = Product.objects.filter(price__gt=100).values_list('name', 'price')  # çµæœ: [('Product A', 150), ('Product B', 200), ...]

# é€éç´¢å¼•æ“ä½œå–å‡ºå…·é«”å€¼
for product in product_data:
    print(product[0], product[1])  # é€™æ¨£å¯ä»¥å–å‡ºåç¨±å’Œåƒ¹æ ¼

```

âœ… **ä½¿ç”¨ .first() æˆ– .last():**
```python

# å–å¾—ç¬¬ä¸€æ¢ç¬¦åˆæ¢ä»¶çš„å•†å“
first_product = Product.objects.filter(price__gt=100).first()

# å¦‚æœæœ‰æ‰¾åˆ°å•†å“ï¼Œå‰‡å¯ä»¥è¨ªå•å®ƒçš„å±¬æ€§
if first_product:
    print(first_product.name, first_product.price)
else:
    print("æ²’æœ‰ç¬¦åˆæ¢ä»¶çš„å•†å“")
```

âœ… **ä½¿ç”¨ .get()è¿”å›ç‚ºä¸€çµæœ:**
```python
obj = Model.objects.get(id=1)
print(obj.field_name)  # å–å¾—æ¬„ä½å€¼
```

âœ… **è½‰æ›ç‚ºåˆ—è¡¨:**
```python
query_set = Model.objects.filter(...)
obj_list = list(query_set)

for obj in obj_list:
    print(obj.field_name)
```


## 3. __æŸ¥è©¢æ¢ä»¶çš„é€£æ¥ç¬¦
åœ¨ Django çš„ ORMä¸­ __ æ˜¯ä¸€ç¨®ç”¨æ–¼ æŸ¥è©¢æ¢ä»¶çš„é€£æ¥ç¬¦ï¼Œç”¨ä¾†è¡¨é” æ¬„ä½æŸ¥è©¢ã€æŸ¥è©¢æ¢ä»¶ã€æˆ–è·¨æ¨¡å‹é—œè¯ ç­‰æ“ä½œã€‚

âœ…åŸºæœ¬èªæ³•: field__condition

ç¯„ä¾‹::
```python
    # ç›¸ç•¶æ–¼ï¼šSELECT * FROM product WHERE name = 'iPhone';
    Product.objects.filter(name__exact='iPhone')
```       


## 4. å¸¸ç”¨çš„æŸ¥è©¢æ¢ä»¶

ğŸ” **1. ç²¾ç¢ºåŒ¹é…èˆ‡æ¨¡ç³ŠæŸ¥è©¢ï¼ˆExact & Pattern Matchingï¼‰**

- **exact**: ç²¾ç¢ºåŒ¹é…
- **iexact**: ä¸å€åˆ†å¤§å°å¯«çš„ç²¾ç¢ºåŒ¹é…
- **contains**: åŒ…å«æŒ‡å®šå­—ä¸²
- **icontains**: ä¸å€åˆ†å¤§å°å¯«çš„åŒ…å«æŸ¥è©¢
- **startswith**: ä»¥æŸå€‹å­—ä¸²é–‹é ­
- **istartswith**: ä¸å€åˆ†å¤§å°å¯«çš„é–‹é ­æŸ¥è©¢
- **endswith**: ä»¥æŸå€‹å­—ä¸²çµå°¾
- **iendswith**: ä¸å€åˆ†å¤§å°å¯«çš„çµå°¾æŸ¥è©¢


ğŸ“… **2. æ—¥æœŸèˆ‡æ™‚é–“çš„æ¢ä»¶æŸ¥è©¢ï¼ˆDate/Time Lookupsï¼‰**

ğŸ“† **åŸºç¤æ—¥æœŸæŸ¥è©¢**

- **date**: æ¯”è¼ƒæ—¥æœŸï¼ˆå¿½ç•¥æ™‚é–“ï¼‰
- **year**: ç¯©é¸æŒ‡å®šå¹´ä»½
- **month**: ç¯©é¸æŒ‡å®šæœˆä»½
- **day**: ç¯©é¸æŒ‡å®šæ—¥
- **week**: ç¯©é¸æŒ‡å®šé€±
- **week_day**: ç¯©é¸æ˜ŸæœŸå¹¾ï¼ˆ1=æ˜ŸæœŸæ—¥ï¼‰
- **quarter**: ç¯©é¸å­£åº¦ï¼ˆ1~4ï¼‰


â° **æ™‚é–“æŸ¥è©¢**

- **time**: æ¯”è¼ƒå…·é«”æ™‚é–“ï¼ˆå¿½ç•¥æ—¥æœŸï¼‰
- **hour**: ç¯©é¸æŒ‡å®šå°æ™‚
- **minute**: ç¯©é¸æŒ‡å®šåˆ†é˜
- **second**: ç¯©é¸æŒ‡å®šç§’æ•¸


â±ï¸ **3. ç¯„åœèˆ‡æ¯”è¼ƒæŸ¥è©¢ï¼ˆRange & Comparisonï¼‰**

- **gt**: å¤§æ–¼æŒ‡å®šæ•¸å€¼/æ—¥æœŸ/æ™‚é–“
- **gte**: å¤§æ–¼ç­‰æ–¼æŒ‡å®šæ•¸å€¼/æ—¥æœŸ/æ™‚é–“
- **lt**: å°æ–¼æŒ‡å®šæ•¸å€¼/æ—¥æœŸ/æ™‚é–“
- **lte**: å°æ–¼ç­‰æ–¼æŒ‡å®šæ•¸å€¼/æ—¥æœŸ/æ™‚é–“
- **range**: åœ¨ç¯„åœä¹‹é–“ï¼ˆå«é ­å°¾ï¼‰
- **in**: åŒ…å«åœ¨çµ¦å®šçš„åˆ—è¡¨ä¸­ex:[1,2,3]
- **isnull**: åˆ¤æ–·æ˜¯å¦ç‚º NULL
