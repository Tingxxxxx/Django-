

## ğŸ”§ æ­¥é©Ÿä¸€ï¼šå®‰è£ç›¸é—œå¥—ä»¶
```bash
pip install boto3 django-storages
```
## ğŸ”§ æ­¥é©ŸäºŒï¼šè¨­å®š settings.py
åŠ å…¥ä»¥ä¸‹è¨­å®šï¼Œä¾†è®“ Django ä½¿ç”¨ Amazon S3 å„²å­˜åª’é«”æª”æ¡ˆï¼š

```python
# settings.py

INSTALLED_APPS += ['storages']  # âœ…å¿…è¦ï¼šåŠ å…¥ django-storages å¥—ä»¶ï¼Œæ‰èƒ½è®“ Django ä½¿ç”¨ S3 å„²å­˜å¾Œç«¯

# âœ…å¿…è¦ï¼šAWS é‡‘é‘°è¨­å®šï¼ˆè«‹å‹™å¿…ä¿å¯†ï¼Œä¸è¦ä¸Šå‚³åˆ° GitHubï¼‰
AWS_ACCESS_KEY_ID = ''            # AWS çš„ Access Key IDï¼ˆå¸³è™Ÿï¼‰
AWS_SECRET_ACCESS_KEY = ''        # AWS çš„ Secret Access Keyï¼ˆå¯†ç¢¼ï¼‰

# âœ…å¿…è¦ï¼šä½ çš„ S3 bucket åç¨±ï¼ˆå¿…é ˆå…ˆåˆ° AWS ä¸Šå»ºç«‹ï¼‰
AWS_STORAGE_BUCKET_NAME = ''      # ä¾‹å¦‚ï¼š'drfmall'

# â˜‘ï¸å»ºè­°ï¼šæŒ‡å®š AWS æ‰€åœ¨å€åŸŸï¼Œè‹¥ä¸æŒ‡å®šæœ‰äº›å€åŸŸæœƒç„¡æ³•é€£ç·š
AWS_S3_REGION_NAME = 'ap-northeast-3'  # å¤§é˜ªåœ°å€çš„ä»£ç¢¼

# â˜‘ï¸å»ºè­°ï¼šè‡ªè¨‚ S3 ä¸»æ©Ÿç¶²å€ï¼Œè®“åœ–ç‰‡å¯ç”¢ç”Ÿä¹¾æ·¨çš„å…¬é–‹ URL
# ä¾‹å¦‚ï¼šhttps://drfmall.s3.ap-northeast-3.amazonaws.com/
AWS_S3_CUSTOM_DOMAIN = f'{AWS_STORAGE_BUCKET_NAME}.s3.{AWS_S3_REGION_NAME}.amazonaws.com'

# â˜‘ï¸å»ºè­°ï¼šè¨­å®šåª’é«”æª”æ¡ˆ URL é–‹é ­ï¼Œè®“åœ–ç‰‡é€£çµæ­£ç¢ºæŒ‡å‘ S3
# ä¾‹å¦‚ï¼šhttps://drfmall.s3.ap-northeast-3.amazonaws.com/products/example.jpg
MEDIA_URL = f'https://{AWS_S3_CUSTOM_DOMAIN}/'

# â˜‘ï¸å»ºè­°ï¼šé—œé–‰é è¨­ ACL æ¬Šé™ï¼Œå¦å‰‡ä¸Šå‚³çš„æª”æ¡ˆæœƒæ˜¯ privateï¼Œå¤–éƒ¨ç„¡æ³•ç€è¦½
AWS_DEFAULT_ACL = None

# â˜‘ï¸å»ºè­°ï¼šç¦æ­¢ä¸Šå‚³åŒåæª”æ¡ˆæ™‚è¦†è“‹ï¼Œç³»çµ±æœƒè‡ªå‹•é‡æ–°å‘½åï¼ˆé¿å…è¦†è“‹æ‰åŸåœ–ï¼‰
AWS_S3_FILE_OVERWRITE = False

# â˜‘ï¸å»ºè­°ï¼šä½¿ç”¨è™›æ“¬ä¸»æ©Ÿé¢¨æ ¼ URLï¼ˆé è¨­å·²æ”¯æ´ï¼‰ï¼Œä¾‹å¦‚ bucket-name.s3.region.amazonaws.com
AWS_S3_ADDRESSING_STYLE = "virtual"

# â˜‘ï¸å»ºè­°ï¼šä½¿ç”¨æ–°ç‰ˆ S3 çš„ç°½ç« æ–¹å¼ v4ï¼Œå¦å‰‡éƒ¨åˆ†å€åŸŸï¼ˆå¦‚ ap-northeast-3ï¼‰æœƒå‡ºéŒ¯
AWS_S3_SIGNATURE_VERSION = "s3v4"

# âœ…å¿…è¦ï¼šæŒ‡å®šåª’é«”æª”æ¡ˆä½¿ç”¨ S3 ä½œç‚ºå„²å­˜å¾Œç«¯ï¼ˆé—œéµè¨­å®šï¼‰
DEFAULT_FILE_STORAGE = 'storages.backends.s3boto3.S3Boto3Storage'

# â˜‘ï¸å»ºè­° åŠ å¿«åœ–ç‰‡è¼‰å…¥é€Ÿåº¦ï¼šä½¿ç”¨å¿«å–ç‚º S3 ä¸Šçš„åª’é«”æª”æ¡ˆåŠ ä¸Šå¿«å–æ§åˆ¶æ¨™é ­ï¼ˆåŠ é€Ÿéœæ…‹è³‡æºè¼‰å…¥ï¼‰
AWS_S3_OBJECT_PARAMETERS = {
    "CacheControl": "max-age=86400",  # å¿«å– 1 å¤©ï¼ˆå–®ä½ï¼šç§’ï¼‰
}

# â˜‘ï¸å»ºè­° è‹¥æœ‰ä½¿ç”¨ CloudFront CDNï¼Œå¯ä»¥æŒ‡å®šç‚ºä½ çš„ CloudFront ç¶²åŸŸ
AWS_S3_CUSTOM_DOMAIN = 'cdn.example.com'  # âš ï¸æ”¹æˆä½ çš„ CloudFront ç¶²å€
MEDIA_URL = f'https://{AWS_S3_CUSTOM_DOMAIN}/'

```


## ğŸ—ï¸ æ­¥é©Ÿä¸‰ï¼šå»ºç«‹ Model ä¸¦åœ¨ admin è£¡é¡¯ç¤ºåœ–ç‰‡ä¸Šå‚³
ç¯„ä¾‹å•†å“æ¨¡å‹ Productï¼š

```python
# models.py

from django.db import models
from django.core.files.storage import default_storage

# ä½¿ç”¨default_storageè®€å–djangoå…¨å±€è¨­å®š
class Product(models.Model):
    image = models.ImageField(upload_to='products/', storage=default_storage) # ä¸Šå‚³åˆ° S3 çš„ products/ è³‡æ–™å¤¾

    def __str__(self):
        return self.name

from storages.backends.s3boto3 import S3Boto3Storage

# æ˜ç¢ºæŒ‡å®šå„²å­˜é¡
class Test(BaseModel):
    image1 = models.ImageField(storage=S3Boto3Storage())


```
âœ… æ³¨æ„: 
- å¦‚æœä½¿ç”¨djangoå…§å»ºçš„ImageFieldæœ€å¥½è¦æ˜ç¢ºæŒ‡å®š`storage`åƒæ•¸ï¼Œä¸ç„¶å°±ç®—å·²æœ‰åœ¨`settings.py`è¨­ç½®å…¨å±€`DEFAULT_FILE_STORAGE`ï¼Œä½†å¾ˆå¯èƒ½å› å…§éƒ¨æ¨¡çµ„è¼‰å…¥é †åºçš„åŸå› è®€ä¸åˆ°
- `default_storage`æœƒè¼‰å…¥djangoä¸­çš„å…¨å±€è¨­å®š
        

## ğŸ–¥ï¸ æ­¥é©Ÿå››ï¼šåœ¨ admin.py é¡¯ç¤ºåœ–ç‰‡
```python
# admin.py

from django.contrib import admin
from .models import Product
from django.utils.html import format_html

class ProductAdmin(admin.ModelAdmin):
    list_display = ('name', 'image_preview')

    def image_preview(self, obj):
        if obj.image:
            return format_html('<img src="{}" width="100" />', obj.image.url)
        return "-"
    image_preview.short_description = 'Image Preview'

admin.site.register(Product, ProductAdmin)
```

##ã€€ğŸŒ å‰ç«¯ HTML é¡¯ç¤ºåœ–ç‰‡ï¼ˆç¯„ä¾‹ï¼‰
åœ¨ä½ çš„å‰ç«¯é é¢æ¨¡æ¿ä¸­ï¼ˆä¾‹å¦‚ product_detail.htmlï¼‰ï¼š
```html
<img src="{{ product.image.url }}" alt="{{ product.name }}">
```

âœ… æœ€çµ‚æˆæœ
Admin å¯ä¸Šå‚³å•†å“åœ–ç‰‡ã€‚

åœ–ç‰‡æœƒè‡ªå‹•å­˜å…¥ S3 ä¸¦å–å¾— URLã€‚

å‰ç«¯åªè¦ç”¨ product.image.url å³å¯é¡¯ç¤ºã€‚


## ğŸ”§ è£œå……:è‡ªè¨‚ç¾©å„²å­˜é¡æ§åˆ¶ä¸Šå‚³é‚è¼¯
åœ¨ Django ä¸­ï¼Œå¯ä»¥é€éè‡ªè¨‚ç¾©ä¸€å€‹ S3 å„²å­˜é¡åˆ¥ ä¾†ç´°ç·»æ§åˆ¶ä¸Šå‚³é‚è¼¯ï¼Œä¾‹å¦‚ï¼šæŒ‡å®šå„²å­˜è·¯å¾‘ã€é è¨­å­˜å–æ¬Šé™ã€æ˜¯å¦è¦†è“‹æª”æ¡ˆã€ä½¿ç”¨ä¸åŒçš„ bucket ç­‰ã€‚é€™æ¨£ä¸å¿…åœ¨æ¯å€‹ ImageField ä¸Šå¯«ä¸€å †é‡è¤‡åƒæ•¸

#### âœ… ç¯„ä¾‹ï¼šè‡ªè¨‚ç¾© S3 å„²å­˜é¡åˆ¥

```py
# storages_backends.py

from storages.backends.s3boto3 import S3Boto3Storage

# è‡ªè¨‚ç¾© S3 å„²å­˜ï¼šå„²å­˜å•†å“åœ–ç‰‡
class ProductImageStorage(S3Boto3Storage):
    location = 'products'           # ä¸Šå‚³åˆ° S3 ä¸­çš„ products/ è³‡æ–™å¤¾
    default_acl = None              # ä¸è¨­å…¬é–‹å­˜å–æ¬Šé™ï¼ˆç”± bucket è¨­å®šæ±ºå®šï¼‰
    file_overwrite = False          # è‹¥æª”åç›¸åŒï¼Œä¸è¦†è“‹åŸæª”
    custom_domain = False           # ä¸ç”¨é è¨­çš„ custom domainï¼Œä½¿ç”¨ S3 åŸå§‹ç¶²å€

```
#### âœ… æ¨¡å‹ä¸­ä½¿ç”¨è‡ªè¨‚ç¾©å„²å­˜ï¼š


```py
# models.py

from django.db import models
from .storages_backends import ProductImageStorage

class Product(models.Model):
    name = models.CharField(max_length=100)
    description = models.TextField()
    image = models.ImageField(storage=ProductImageStorage())  # ä½¿ç”¨è‡ªè¨‚å„²å­˜å¾Œç«¯

    def __str__(self):
        return self.name
```